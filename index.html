<div id="workspace-400" class="workspace">
            <button class="back-btn" onclick="goBackMain()">â—€ ë©”ì¸ìœ¼ë¡œ</button>
            <h3 style="margin-bottom:20px;">ğŸ”¬ R&D ì—°êµ¬ ë…¸íŠ¸</h3>

            <div class="info-card" style="border: 2px solid #3498db;">
                <h4 style="margin-top:0;">ìƒˆë¡œìš´ ì•„ì´ë””ì–´ ê¸°ë¡</h4>
                <div style="display:flex; gap:5px; margin-bottom:10px;">
                    <select id="rnd-status" style="padding:10px; border:1px solid #ddd; border-radius:4px;">
                        <option value="ì•„ì´ë””ì–´">ğŸ’¡ ì•„ì´ë””ì–´</option>
                        <option value="í…ŒìŠ¤íŠ¸ì¤‘">ğŸ”¥ í…ŒìŠ¤íŠ¸ì¤‘</option>
                        <option value="ì„±ê³µ">ğŸ‰ ì„±ê³µ</option>
                        <option value="ë³´ë¥˜">ğŸ§Š ë³´ë¥˜</option>
                    </select>
                    <input type="text" id="rnd-menu" placeholder="ë©”ë‰´ëª… (ì˜ˆ: ëƒ‰ì´ íŒŒìŠ¤íƒ€)" style="flex:1;">
                </div>
                <textarea id="rnd-note" placeholder="ì—°êµ¬ ë…¸íŠ¸ (ë°°í•©ë¹„, ì¡°ë¦¬ë²• ë“±)" style="width:100%; height:60px; padding:10px; border:1px solid #ddd; border-radius:4px; margin-bottom:10px;"></textarea>
                <textarea id="rnd-feedback" placeholder="í”¼ë“œë°± (ë§› í‰ê°€, ë³´ì™„ì )" style="width:100%; height:40px; padding:10px; border:1px solid #ddd; border-radius:4px; margin-bottom:10px;"></textarea>
                
                <div style="margin-bottom:10px;">
                    <label for="rnd-photo" style="display:inline-block; padding:10px 15px; background:#e67e22; color:white; border-radius:4px; cursor:pointer; font-weight:bold; font-size:13px;">
                        ğŸ“· ì‚¬ì§„ ì°ê¸° / ì²¨ë¶€
                    </label>
                    <input type="file" id="rnd-photo" accept="image/*" capture="camera" style="display:none;" onchange="previewImage()">
                    <span id="file-name" style="font-size:12px; color:#777; margin-left:10px;">ì„ íƒëœ ì‚¬ì§„ ì—†ìŒ</span>
                </div>
                <img id="img-preview" style="width:100%; max-height:200px; object-fit:contain; display:none; margin-bottom:10px; border-radius:4px;">

                <button class="action-btn" onclick="saveRnD()" style="width:100%; background:#3498db;">ì €ì¥í•˜ê¸°</button>
            </div>

            <div id="rnd-list-area"></div>
        </div>

    <script>
        // ... (ê¸°ì¡´ ë³€ìˆ˜ ë° í•¨ìˆ˜ë“¤) ...

        function openModule(code) {
            // ... (ê¸°ì¡´ ëª¨ë“ˆ ì˜¤í”ˆ ë¡œì§) ...
            if (code === '400') {
                document.getElementById('workspace-400').style.display = 'block';
                loadRnD(); // R&D ëª©ë¡ ë¶ˆëŸ¬ì˜¤ê¸°
            }
        }

        // [400] R&D ê¸°ëŠ¥
        let currentImageBase64 = null; // ì‚¬ì§„ ë°ì´í„° ë‹´ì„ ë³€ìˆ˜

        function previewImage() {
            const file = document.getElementById('rnd-photo').files[0];
            if (file) {
                document.getElementById('file-name').innerText = file.name;
                const reader = new FileReader();
                reader.onload = function(e) {
                    document.getElementById('img-preview').src = e.target.result;
                    document.getElementById('img-preview').style.display = 'block';
                    // Base64 ë°ì´í„° ì €ì¥ (ì•ì— 'data:image/jpeg;base64,' ë¶€ë¶„ ì œê±°í•˜ê³  ìˆœìˆ˜ ë°ì´í„°ë§Œ)
                    currentImageBase64 = {
                        data: e.target.result.split(',')[1],
                        type: file.type
                    };
                };
                reader.readAsDataURL(file);
            }
        }

        function saveRnD() {
            const status = document.getElementById('rnd-status').value;
            const menu = document.getElementById('rnd-menu').value;
            const note = document.getElementById('rnd-note').value;
            const feedback = document.getElementById('rnd-feedback').value;

            if (!menu) { alert("ë©”ë‰´ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”."); return; }

            // ë²„íŠ¼ ë¹„í™œì„±í™” (ì¤‘ë³µ í´ë¦­ ë°©ì§€)
            const btn = document.querySelector('#workspace-400 .action-btn');
            btn.innerText = "ì €ì¥ ì¤‘...";
            btn.disabled = true;

            const item = {
                date: new Date().toISOString().split('T')[0],
                status: status,
                menu: menu,
                note: note,
                feedback: feedback,
                image: currentImageBase64 // ì‚¬ì§„ ë°ì´í„°
            };

            // ì„œë²„ë¡œ ì „ì†¡ (google.script.run ì‚¬ìš©)
            google.script.run.withSuccessHandler(function(res) {
                alert("ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
                // ì…ë ¥ì°½ ì´ˆê¸°í™”
                document.getElementById('rnd-menu').value = "";
                document.getElementById('rnd-note').value = "";
                document.getElementById('rnd-feedback').value = "";
                document.getElementById('rnd-photo').value = "";
                document.getElementById('file-name').innerText = "ì„ íƒëœ ì‚¬ì§„ ì—†ìŒ";
                document.getElementById('img-preview').style.display = "none";
                currentImageBase64 = null;
                btn.innerText = "ì €ì¥í•˜ê¸°";
                btn.disabled = false;
                loadRnD(); // ëª©ë¡ ê°±ì‹ 
            }).saveRnDItem(item);
        }

        function loadRnD() {
            const area = document.getElementById('rnd-list-area');
            area.innerHTML = "<p style='text-align:center; color:#999'>ë¡œë”© ì¤‘...</p>";
            
            fetch(`${gasUrl}?action=rnd`).then(r => r.json()).then(list => {
                if(list.length === 0) { area.innerHTML = "<p style='text-align:center; color:#999'>ê¸°ë¡ëœ ì—°êµ¬ê°€ ì—†ìŠµë‹ˆë‹¤.</p>"; return; }
                
                let html = "";
                list.forEach(item => {
                    // ìƒíƒœë³„ ìƒ‰ìƒ
                    let color = "#777";
                    if(item.status === "ì•„ì´ë””ì–´") color = "#f39c12";
                    if(item.status === "í…ŒìŠ¤íŠ¸ì¤‘") color = "#e74c3c";
                    if(item.status === "ì„±ê³µ") color = "#27ae60";

                    let imgHtml = item.photo ? `<div style="margin-top:10px;"><img src="${item.photo}" style="width:100%; border-radius:8px;"></div>` : "";

                    html += `<div class="info-card">
                        <div style="display:flex; justify-content:space-between; margin-bottom:5px;">
                            <span style="font-weight:bold; font-size:16px;">${item.menu}</span>
                            <span style="font-size:12px; font-weight:bold; color:${color}; border:1px solid ${color}; padding:2px 6px; border-radius:4px;">${item.status}</span>
                        </div>
                        <div style="font-size:12px; color:#999; margin-bottom:10px;">${item.date}</div>
                        <div style="font-size:14px; color:#555; white-space:pre-wrap; margin-bottom:5px;">${item.note}</div>
                        ${item.feedback ? `<div style="background:#f9f9f9; padding:8px; font-size:13px; color:#333; border-radius:4px;">ğŸ’¬ ${item.feedback}</div>` : ""}
                        ${imgHtml}
                    </div>`;
                });
                area.innerHTML = html;
            });
        }
    </script>
